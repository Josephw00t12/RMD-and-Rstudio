---
title: "FA5"
author: "Joseph Raphael M. Espiritu, Harneyyer Clores"
output:
  github_document: default
  pdf_document:
    latex_engine: xelatex
  word_document: default
  html_document: default
---

```{r echo=TRUE}
knitr::opts_chunk$set(echo = TRUE)
```

# Problem 8.17 – Mean and Variance of X

Midwestern University has 1/3 of its students taking **9 credit hours**, 1/3 taking **12 credit hours**, and 1/3 taking **15 credit hours**.  
We define \( X \) as the number of credit hours.  
Thus, the probability distribution is:

| X | p(X) |
|---|------|
| 9 | 1/3  |
| 12 | 1/3 |
| 15 | 1/3 |

The mean and variance are calculated as follows:

\[ \mu_X = \sum X p(X) = 9(1/3) + 12(1/3) + 15(1/3) = 12 \]

\[ \sigma_X^2 = \sum X^2 p(X) - \mu_X^2 = (81 + 144 + 225)(1/3) - 144 = 150 - 144 = 6 \]

Hence, the distribution is **uniform**.

```{r echo=TRUE}
X <- c(9, 12, 15)
pX <- c(1/3, 1/3, 1/3)

mu_X <- sum(X * pX)
var_X <- sum(X^2 * pX) - mu_X^2

mu_X
var_X
```

---

# Problem 8.18 – Sampling Distribution of the Mean

We now take **all samples of size n = 2 (with replacement)** from this population.

Each pair (e.g., (9,9), (9,12), (9,15), etc.) is a **sample**.  
For each sample, we compute its **sample mean (x̄)**.

| Sample | Mean (x̄) | Probability p(x̄) | x̄ × p(x̄) | x̄² × p(x̄) |
|---------|-----------|------------------|------------|-------------|
| (9,9) | 9 | 1/9 | 1.0000 | 9 |
| (9,12) | 10.5 | 2/9 | 2.3333 | 24.5 |
| (9,15) | 12 | 1/9 | 1.3333 | 16 |
| (12,9) | 10.5 | 2/9 | 2.3333 | 24.5 |
| (12,12) | 12 | 1/9 | 1.3333 | 16 |
| (12,15) | 13.5 | 2/9 | 3.0000 | 40.5 |
| (15,9) | 12 | 1/9 | 1.3333 | 16 |
| (15,12) | 13.5 | 2/9 | 3.0000 | 40.5 |
| (15,15) | 15 | 1/9 | 1.6667 | 25 |

The total probability = 1.  
Now we can find:

\[ \mu_{\bar{X}} = \sum (\bar{X} \cdot p(\bar{X})) = 12 \]

\[ \sigma_{\bar{X}}^2 = \sum (\bar{X}^2 \cdot p(\bar{X})) - \mu_{\bar{X}}^2 = 12 - 12^2 = 3 \]

Hence, \( \sigma_{\bar{X}}^2 = \frac{\sigma_X^2}{2} = \frac{6}{2} = 3 \).

```{r echo=TRUE}
samples <- expand.grid(X, X)
xbar <- rowMeans(samples)

# Probability for each unique mean value
xbar_values <- unique(xbar)
p_xbar <- table(xbar) / length(xbar)

# Expected mean and variance of sampling distribution
mu_xbar <- sum(as.numeric(names(p_xbar)) * p_xbar)
var_xbar <- sum((as.numeric(names(p_xbar))^2) * p_xbar) - mu_xbar^2

mu_xbar
var_xbar

library(ggplot2)

# Create data frame for plotting
df <- data.frame(
  xbar = as.numeric(names(p_xbar)),
  probability = as.numeric(p_xbar)
)

# Plot distribution
ggplot(df, aes(x = factor(xbar), y = probability)) +
  geom_bar(stat = "identity", fill = "skyblue", color = "black") +
  geom_text(aes(label = round(probability, 3)), vjust = -0.5) +
  labs(
    title = "Sampling Distribution of the Sample Mean (x̄)",
    x = "Sample Mean (x̄)",
    y = "Probability"
  ) +
  theme_minimal()
```

---

# Step-by-Step Explanation of Each Column

1. **Sample (A, B)** – All possible combinations of X values when sampling with replacement (9, 12, 15). There are 9 total combinations (3×3).  
2. **x̄ (Mean)** – The mean of each sample. Example: (9,15) ⇒ (9+15)/2 = 12.  
3. **p(x̄)** – The probability of each unique mean occurring. Since all combinations are equally likely (1/9 each), p(x̄) = (number of occurrences of x̄)/9.  
4. **x̄ × p(x̄)** – Used to compute the expected mean of the sampling distribution.  
5. **x̄² × p(x̄)** – Used to compute the variance of the sampling distribution.  

---

# Verification

```{r echo=TRUE}
c(mu_X = mu_X, mu_xbar = mu_xbar, var_X = var_X, var_xbar = var_xbar)
```

We find that:  
\( \mu_X = \mu_{\bar{X}} = 12 \)  
\( \sigma_{\bar{X}}^2 = \frac{\sigma_X^2}{2} = 3 \)

Thus, the theory holds true.

# Problem 8.21:

```{r echo=TRUE}
population <- c(3, 7, 11, 15)

pop_mean <- mean(population)
pop_sd <- sd(population)  # sample SD by default; use population SD instead
pop_sd <- sqrt(mean((population - pop_mean)^2))  # population SD formula
pop_mean; pop_sd
samples <- expand.grid(population, population)
sample_means <- rowMeans(samples)
table_means <- as.data.frame(table(sample_means))
table_means$Probability <- table_means$Freq / nrow(samples)
table_means
mean_sampling <- sum(as.numeric(as.character(table_means$sample_means)) * table_means$Probability)
sd_sampling <- sqrt(sum((as.numeric(as.character(table_means$sample_means)) - mean_sampling)^2 * table_means$Probability))
mean_sampling; sd_sampling
theoretical_mean <- pop_mean
theoretical_sd <- pop_sd / sqrt(2)

theoretical_mean; theoretical_sd

library(ggplot2)

ggplot(table_means, aes(x = as.numeric(as.character(sample_means)), 
                        y = Probability)) +
  geom_col(fill = "skyblue", color = "black") +
  geom_text(aes(label = round(Probability, 3)), vjust = -0.5) +
  labs(title = "Sampling Distribution of the Sample Mean (x̄)",
       x = "Sample Mean (x̄)",
       y = "Probability") +
  theme_minimal()

data.frame(
  Description = c("Population Mean (μ)", 
                  "Population SD (σ)", 
                  "Mean of Sampling Dist. (μx̄)", 
                  "SD of Sampling Dist. (σx̄)"),
  Value = c(pop_mean, pop_sd, mean_sampling, sd_sampling)
)

```

# Problem 8.34:

```{r echo=TRUE}
#(a) Probability that less than 40% will be boys
# exact binomial
p_less_80_exact <- pbinom(79, size = 200, prob = 0.5)
p_less_80_exact


#(b) Probability that between 43% and 57% will be girls
# exact binomial: P(86 <= X <= 114)
p_between_exact <- pbinom(114, size = 200, prob = 0.5) - pbinom(85, size = 200, prob = 0.5)
p_between_exact

#(c) Probability that more than 54% will be boys
# exact binomial: P(X >= 109)
p_more_108_exact <- 1 - pbinom(108, size = 200, prob = 0.5)
p_more_108_exact


```

# Problem 8.49:

```{r echo=TRUE}

x <- c(6, 9, 12, 15, 18)
p <- c(0.1, 0.2, 0.4, 0.2, 0.1)
mu <- sum(x * p)
sigma2 <- sum((x - mu)^2 * p)

mu
sigma2

samples <- expand.grid(x1 = x, x2 = x) # all 25 combinations
samples$mean <- (samples$x1 + samples$x2) / 2
samples$prob <- p[match(samples$x1, x)] * p[match(samples$x2, x)]

head(samples, 10)

sum(samples$prob)

knitr::kable(samples, caption = "All 25 samples (with replacement), their means, and probabilities")

sampling_dist <- aggregate(prob ~ mean, data = samples, sum)
knitr::kable(sampling_dist, caption = "Sampling Distribution of the Sample Mean")

mu_xbar <- sum(sampling_dist$mean * sampling_dist$prob)
var_xbar <- sum((sampling_dist$mean - mu_xbar)^2 * sampling_dist$prob)

mu_xbar
var_xbar

sigma2 / 2

```